<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td><pre style="margin: 0; line-height: 125%">INCLUDE <span style="background-color: #fff0f0">&#39;test/queries/mddb/schemas.sql&#39;</span>;

<span style="color: #888888">-- Query 1: compute the radial distribution of all water molecules from a reference</span>
<span style="color: #008800; font-weight: bold">select</span> P.trj_id, P.t, <span style="color: #008800; font-weight: bold">avg</span>(vec_length(P.x<span style="color: #333333">-</span>P2.x, P.y<span style="color: #333333">-</span>P2.y, P.z<span style="color: #333333">-</span>P2.z)) <span style="color: #008800; font-weight: bold">as</span> rdf
<span style="color: #008800; font-weight: bold">from</span> AtomPositions P, AtomMeta M,
     AtomPositions P2, AtomMeta M2
<span style="color: #008800; font-weight: bold">where</span> P.trj_id        <span style="color: #333333">=</span> P2.trj_id 
<span style="color: #008800; font-weight: bold">and</span>   P.t             <span style="color: #333333">=</span> P2.t
<span style="color: #008800; font-weight: bold">and</span>   P.atom_id       <span style="color: #333333">=</span> M.atom_id
<span style="color: #008800; font-weight: bold">and</span>   P2.atom_id      <span style="color: #333333">=</span> M2.atom_id
<span style="color: #008800; font-weight: bold">and</span>   M.residue_name  <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;LYS&#39;</span>
<span style="color: #008800; font-weight: bold">and</span>   M.atom_name     <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;NZ&#39;</span>
<span style="color: #008800; font-weight: bold">and</span>   M2.residue_name <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;TIP3&#39;</span>
<span style="color: #008800; font-weight: bold">and</span>   M2.atom_name    <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;OH2&#39;</span>
<span style="color: #008800; font-weight: bold">group</span> <span style="color: #008800; font-weight: bold">by</span> P.trj_id, P.t;
</pre></td></tr></table></div>
